"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.isEvmChecksum = void 0;
// Copyright 2017-2024 @polkadot/util-crypto authors & contributors
// SPDX-License-Identifier: Apache-2.0
const keccak_js_1 = require("../../hash/keccak.js");
const hex_js_1 = require("../../hex.js");
const u8a_js_1 = require("../../u8a.js");
function isInvalidChar(char, byte) {
    return char !== (byte > 7 ? char.toUpperCase() : char.toLowerCase());
}
function isEvmChecksum(_address) {
    const address = (0, hex_js_1.hexStripPrefix)(_address);
    const hash = (0, hex_js_1.hexStripPrefix)((0, u8a_js_1.u8aToHex)((0, keccak_js_1.keccakAsU8a)(address.toLowerCase())));
    for (let i = 0; i < 40; i++) {
        if (isInvalidChar(address[i], parseInt(hash[i], 16))) {
            return false;
        }
    }
    return true;
}
exports.isEvmChecksum = isEvmChecksum;
