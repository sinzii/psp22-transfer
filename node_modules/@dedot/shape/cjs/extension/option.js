"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Option = exports.option = void 0;
const utils_1 = require("@dedot/utils");
const deshape_js_1 = require("../deshape.js");
function shouldDecodeInner(input) {
    return !((0, utils_1.isHex)(input) || (0, utils_1.isU8a)(input));
}
function isNone(input) {
    return (0, utils_1.isUndefined)(input) || (0, utils_1.isNull)(input) || input === '0x';
}
function decodeInner($shape, input) {
    // @ts-ignore
    const $some = $shape.metadata[0].args[0];
    return $some.tryDecode(input);
}
function option($some) {
    const shaped = (0, deshape_js_1.option)($some);
    shaped.registerDecoder(isNone, (_, input) => undefined);
    shaped.registerDecoder(shouldDecodeInner, decodeInner);
    return shaped;
}
exports.option = option;
exports.Option = option;
